// merge.js
const fs = require("fs");
const path = require("path");

// List of league playlists to merge
const playlists = [
  "nba.m3u",
  "nhl.m3u",
  "mlb.m3u",
  "nfl.m3u",
  "mls.m3u",
  "wnba.m3u",
  "ufc.m3u",
  "boxing.m3u"
];

let merged = "#EXTM3U\n";

playlists.forEach(file => {
  const filePath = path.join(__dirname, file);

  if (fs.existsSync(filePath)) {
    console.log(`➡️ Adding ${file}`);
    const content = fs.readFileSync(filePath, "utf8");

    // Remove any extra #EXTM3U headers
    merged += content.replace(/^#EXTM3U\s*/i, "") + "\n";
  } else {
    console.warn(`⚠️  Missing file: ${file} (skipping)`);
  }
});

// Trim extra blank lines
merged = merged.trim();

// Write merged playlist
const outputFile = path.join(__dirname, "merged.m3u");
fs.writeFileSync(outputFile, merged, "utf8");
console.log(`✅ Merged playlist saved as ${outputFile}`);
